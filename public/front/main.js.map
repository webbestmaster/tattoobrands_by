{"version":3,"sources":["webpack:///./js/authorization.js","webpack:///../node_modules/classnames/index.js","webpack:///./js/search-page.js","webpack:///./js/index.js","webpack:///./style/css/_root.scss","webpack:///./js/home.js","webpack:///./js/product.js","webpack:///./js/helper/image.js","webpack:///./js/helper/form.js","webpack:///./js/basket.js","webpack:///./js/cart.js","webpack:///./js/ordering.js","webpack:///./js/header-nav.js","webpack:///./js/header-search.js","webpack:///./js/my-lib/search.js","webpack:///./js/my-lib/screen.js","webpack:///./js/category.js"],"names":["$","require","checkForm","getUrlQuery","showError","id","style","timeout","snackbar","content","module","exports","initAuthorizationForm","form","on","evt","preventDefault","ajax","type","url","data","serialize","success","hasOwnProperty","error","redirect","location","href","document","referrer","origin","click","console","log","React","Component","ReactDOM","search","sortProduct","normalizeString","classnames","saveScrollTop","restoreScrollTop","SearchPage","view","state","query","products","isInProgress","searchInput","refs","value","decodeURI","onSearchInput","setState","then","searchResult","length","map","slug","name","description","images","price","promotable","backgroundImage","searchIconClassName","focus","renderList","initPage","wrapper","querySelector","render","window","app","FastClick","homeScripts","productScripts","authorizationScripts","basketScripts","cartScripts","orderingScripts","headerScripts","headerSearchScripts","searchPageScripts","categoryPageScripts","body","initHeaderNav","initHeaderSearch","initSwiper","initPagination","productReview","initBreadCrumbs","initSwiperZoom","initAddToBasketForm","initBasket","initCartTable","initOrderForm","Swiper","cssInitialClass","removeClass","onSwiperResize","swiper","slideHeight","slideWidth","width","documentElement","clientWidth","neededHeight","Math","min","round","neededHeightPx","container","slides","nodes","concat","forEach","Object","assign","node","height","homeSwiper","pagination","paginationClickable","centeredSlides","autoplay","autoplayDisableOnInteraction","loop","onInit","onAfterResize","indexPagination","totalPages","startPage","paginationWrapper","remove","twbsPagination","initiateStartPageClick","visiblePages","prev","next","first","last","onPageClick","page","loadImages","productSwiperImages","productSwiperWrapper","addClass","Array","prototype","slice","call","src","maxHeightImage","sort","image0","image1","size","productSwiper","keyboardControl","product","win","fullPageClassName","onWindowResize","hasClass","toggleClass","dispatchEvent","Event","basket","change","Number","find","val","hasCategoryTheProduct","category","productId","indexOf","findProductPath","passList","callBack","watcher","currentPassList","JSON","parse","stringify","displayName","push","hasResult","shift","categories","some","subCategory","getCategoriesPath","categoryTree","resultObject","result","categoriesPass","_id","categoryHtml","replace","join","productHtml","innerHTML","loadImage","Promise","resolve","reject","image","Image","onLoad","onload","onerror","onError","imageSrcList","all","checkInput","input","hasAttribute","pattern","getAttribute","regExp","RegExp","test","inputs","every","Basket","counter","postfix","empty","numberToMoney","CartTable","items","getItems","newCount","set","ii","article","count","onInputNumberBlur","onInputChange","parseInt","currentTarget","getFullPrice","history","back","createOrder","serializedForm","serializeToJSON","basketItems","updateUserData","orderingForm","clear","catch","narrowWidth","TabContent","props","HeaderNav","activeCategorySlug","isNarrow","nextProps","nextState","nextIsNarrow","closeTabs","classList","add","bindEvents","onResize","addEventListener","newSlug","activeCategory","category1","category2","order","switchTab","narrowRender","openTab","HeaderSearch","hasFocus","onFormSubmit","setTimeout","emptyQuery","promiseCache","fetch","rawResult","json","product1","product2","delta","scrollMethods","docElem","scrollTop","hasCategoryTheCategory","findCategoryPath","categorySlug"],"mappings":"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","file":"main.js","sourcesContent":["/* global document, location, setTimeout */\nconst $ = require('jquery');\nconst {checkForm} = require('./helper/form');\nconst {getUrlQuery} = require('./my-lib/query-parameter');\n\nfunction showError({id}) { // eslint-disable-line complexity\n    const style = 'snackbar';\n    const timeout = 6e3;\n\n    switch (id) {\n        case 'no-needed-data':\n            $.snackbar({\n                content: 'Ошибка: недостаточно данных!', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n            break;\n        case 'user-already-exists':\n            $.snackbar({\n                content: 'Ошибка: пользователь с таким Email уже существует! Попробуйте ВОЙТИ.', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n            break;\n        case 'unknow-sever-error':\n            $.snackbar({\n                content: 'Ошибка: неизвестная ошибка сервера! Да, и такое бывает...', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n            break;\n        case 'user-is-not-exists':\n            $.snackbar({\n                content: 'Ошибка: пользователя с таким Email НЕ существует!', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n            break;\n        case 'wrong-password':\n            $.snackbar({\n                content: 'Ошибка: Пароль неверен!', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n            break;\n\n        default:\n            $.snackbar({\n                content: 'Ошибка: неизвестная ошибка клиента! Да, и такое бывает...', // text of the snackbar\n                style, // add a custom class to your snackbar\n                timeout// time in milliseconds after the snackbar autohides, 0 is disabled\n            });\n    }\n}\n\nmodule.exports.showError = showError;\n\nmodule.exports.initAuthorizationForm = () => {\n    const form = $('.js-authorization-form');\n\n    form.on('submit', evt => evt.preventDefault());\n\n    $('.js-login')\n        .on('click', () => {\n            if (!checkForm(form)) {\n                return;\n            }\n\n            $.ajax({\n                type: 'post',\n                url: '/api/login/',\n                data: form.serialize(), // serializes the form's elements.\n                success: data => {\n                    if (data.hasOwnProperty('error')) {\n                        showError(data.error);\n                        return;\n                    }\n\n                    const redirect = getUrlQuery().redirect;\n\n                    location.href = redirect || document.referrer || location.origin;\n                }\n            });\n        });\n\n    $('.js-register')\n        .on('click', () => {\n            if (!checkForm(form)) {\n                return;\n            }\n\n            $.ajax({\n                type: 'post',\n                url: '/api/registration/',\n                data: form.serialize(), // serializes the form's elements.\n                success: data => {\n                    if (data.hasOwnProperty('error')) {\n                        showError(data.error);\n                        return;\n                    }\n\n                    $.snackbar({\n                        content: 'Регистрация прошла успешно!', // text of the snackbar\n                        style: 'snackbar', // add a custom class to your snackbar\n                        timeout: 3e3// time in milliseconds after the snackbar autohides, 0 is disabled\n                    });\n\n                    $('.js-login').click();\n\n                    console.log('add auto login here');\n                }\n            });\n        });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/authorization.js","/*!\n  Copyright (c) 2016 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tclasses.push(classNames.apply(null, arg));\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/classnames/index.js\n// module id = 127\n// module chunks = 0","/* global document */\nconst React = require('react');\nconst {Component} = React;\nconst ReactDOM = require('react-dom');\nconst {search, sortProduct} = require('./my-lib/search');\nconst {normalizeString} = require('./my-lib/format');\nconst {getUrlQuery} = require('./my-lib/query-parameter');\nconst classnames = require('classnames');\nconst {saveScrollTop, restoreScrollTop} = require('./my-lib/screen');\n\nclass SearchPage extends Component {\n    constructor() {\n        super();\n\n        const view = this;\n\n        view.state = {\n            query: '',\n            products: [],\n            isInProgress: false\n        };\n    }\n\n    componentDidMount() {\n        const view = this;\n        const {query = ''} = getUrlQuery();\n        const {searchInput} = view.refs;\n\n        searchInput.value = decodeURI(query);\n\n        if (query) {\n            view.onSearchInput();\n        }\n    }\n\n    onSearchInput() {\n        const view = this;\n        const {searchInput} = view.refs;\n        const query = normalizeString(searchInput.value);\n\n        saveScrollTop();\n\n        view.setState({isInProgress: true}, restoreScrollTop);\n\n        search(query)\n            .then(searchResult => {\n                if (query !== normalizeString(searchInput.value)) {\n                    return;\n                }\n\n                view.setState({\n                    products: sortProduct(searchResult.products, query),\n                    query,\n                    isInProgress: false\n                }, restoreScrollTop);\n            });\n    }\n\n    renderList() {\n        const view = this;\n        const {state} = view;\n        const {products, query} = state;\n\n        if (!query) {\n            return <h3 className=\"page-header\">Введите запрос для поиска!</h3>;\n        }\n\n        if (!products.length) {\n            return <h3 className=\"page-header\">Ничего не найдено!</h3>;\n        }\n\n        return products.map(({slug, name, description, images, price, promotable}) =>\n            <a onContextMenu={evt => evt.preventDefault()}\n                href={'/product/' + slug}\n                className={classnames('product-preview', {'product-preview--promotable': promotable})}\n                key={slug}>\n                <div className=\"product-preview__image\"\n                    style={{backgroundImage: 'url(' + images[0] + ')'}}/>\n                <h3 className=\"product-preview__name\">{name}</h3>\n                <div className=\"product-preview__description\">{description}</div>\n                <span className=\"product-preview__price\">{price} руб.</span>\n            </a>);\n    }\n\n    render() {\n        const view = this;\n        const {state} = view;\n        const {isInProgress} = state;\n\n        const searchIconClassName = classnames('header-search__icon', {\n            'header-search__icon--in-progress': isInProgress\n        });\n\n        return <div className=\"search-page\">\n            <div className=\"search-page__input-wrapper\">\n                <input\n                    ref=\"searchInput\"\n                    className=\"search-page__input\"\n                    placeholder=\"Поиск...\"\n                    onInput={evt => view.onSearchInput()}\n                />\n                <div onClick={() => view.refs.searchInput.focus()} className={searchIconClassName}/>\n            </div>\n            <div\n                className={classnames(\n                    'products-preview',\n                    'search-page__result',\n                    {'search-page__result--in-progress': isInProgress})\n                }>\n                {view.renderList()}\n            </div>\n        </div>;\n    }\n}\n\nmodule.exports.initPage = () => {\n    const wrapper = document.querySelector('.js-search-page-result');\n\n    if (!wrapper) {\n        return;\n    }\n\n    ReactDOM.render(\n        <SearchPage/>,\n        wrapper\n    );\n};\n\nmodule.exports.SearchPage = SearchPage;\n\n\n\n// WEBPACK FOOTER //\n// ./js/search-page.js","/* global document */\nrequire('./../style/css/_root.scss');\n\nwindow.app = window.app || {};\n\nconst FastClick = require('fastclick');\nconst $ = require('jquery');\n\nconst homeScripts = require('./home');\nconst productScripts = require('./product');\nconst authorizationScripts = require('./authorization');\nconst basketScripts = require('./basket');\nconst cartScripts = require('./cart');\nconst orderingScripts = require('./ordering');\n// const orderScripts = require('./order');\nconst headerScripts = require('./header-nav');\nconst headerSearchScripts = require('./header-search');\nconst searchPageScripts = require('./search-page');\nconst categoryPageScripts = require('./category');\n\n$(() => {\n    // main part\n    new FastClick(document.body); // eslint-disable-line no-new\n\n    // main scripts\n    headerScripts.initHeaderNav();\n\n    // search\n    headerSearchScripts.initHeaderSearch();\n\n    // home\n    homeScripts.initSwiper();\n    homeScripts.initPagination();\n    homeScripts.productReview();\n\n    // product\n    productScripts.initSwiper();\n    productScripts.initBreadCrumbs();\n    productScripts.initSwiperZoom();\n    productScripts.initAddToBasketForm();\n\n    // authorization\n    authorizationScripts.initAuthorizationForm();\n\n    // basket\n    basketScripts.initBasket();\n\n    // cart\n    cartScripts.initCartTable();\n\n    // ordering\n    orderingScripts.initOrderForm();\n\n    // order\n    // orderScripts.initOrderTable();\n    // orderScripts.initPdfOrder();\n\n    // categories\n    categoryPageScripts.initBreadCrumbs();\n\n    // search\n    searchPageScripts.initPage();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./js/index.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/css/_root.scss\n// module id = 321\n// module chunks = 0","/* global document */\nconst Swiper = require('./lib/idangerous.swiper');\nconst $ = require('jquery');\n\nmodule.exports.initSwiper = () => {\n    const cssInitialClass = 'home-swiper-wrapper--wait-for-init';\n\n    $('.' + cssInitialClass).removeClass(cssInitialClass);\n\n    function onSwiperResize(swiper) {\n        // count height\n        // const slideHeight = 261;\n        // const slideWidth = 980;\n        const slideHeight = 325;\n        const slideWidth = 1220;\n        const width = document.documentElement.clientWidth;\n        const neededHeight = Math.min(Math.round(slideHeight * width / slideWidth), slideHeight);\n        const neededHeightPx = neededHeight + 'px';\n\n        // get nodes\n        const {wrapper, container, slides} = swiper;\n        const nodes = [wrapper, container].concat(slides);\n\n        nodes.forEach(node => Object.assign(node.style, {height: neededHeightPx}));\n    }\n\n    const homeSwiper = new Swiper('.js-home-swiper-wrapper', {\n        pagination: '.swiper-pagination',\n        // nextButton: '.swiper-button-next',\n        // prevButton: '.swiper-button-prev',\n        paginationClickable: true,\n        // spaceBetween: 30,\n        centeredSlides: true,\n        autoplay: 6000,\n        autoplayDisableOnInteraction: false,\n        loop: true,\n        onInit: onSwiperResize,\n        onAfterResize: onSwiperResize\n    });\n\n    console.log('home swiper is here ->', homeSwiper);\n};\n\nmodule.exports.initPagination = () => {\n    const {indexPagination} = window.app;\n\n    if (!indexPagination) {\n        console.log('no app.indexPagination');\n        return;\n    }\n\n    const {totalPages, startPage} = indexPagination;\n    const {location} = window;\n\n    const paginationWrapper = $('.js-index-pagination');\n\n    if (totalPages === 1) {\n        paginationWrapper.remove();\n        return;\n    }\n\n    paginationWrapper.twbsPagination({\n        totalPages,\n        startPage,\n\n        initiateStartPageClick: false,\n        visiblePages: 5,\n\n        prev: '&#8672;',\n        next: '&#8674;',\n\n        first: '&#8676;',\n        last: '&#8677;',\n\n        onPageClick: (evt, page) => Object.assign(location, {search: 'page=' + page})\n    });\n};\n\nmodule.exports.productReview = () => {\n    $('.js-product-preview').on('contextmenu', evt => evt.preventDefault());\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/home.js","/* global document, Event */\nconst Swiper = require('./lib/idangerous.swiper');\nconst $ = require('jquery');\n\nconst {loadImages} = require('./helper/image');\n\nmodule.exports.initSwiper = () => {\n    const productSwiperImages = $('.js-product-swiper-img');\n    const productSwiperWrapper = $('.js-product-swiper-wrapper');\n\n    if (productSwiperImages.length <= 1) {\n        productSwiperWrapper.addClass('product-swiper-wrapper--one-image');\n        console.log('no product swiper, here is one image');\n        return;\n    }\n\n    loadImages(Array.prototype.slice.call(productSwiperImages).map(({src}) => src)) // eslint-disable-line prefer-reflect\n        .then(images => {\n            const maxHeightImage = images.sort((image0, image1) => image1.height - image0.height)[0];\n\n            function onSwiperResize(swiper) {\n                const {wrapper, container, slides} = swiper;\n                const size = Math.min(maxHeightImage.height, container.clientWidth) + 'px';\n                const nodes = [wrapper, container].concat(slides);\n\n                nodes.forEach(node => Object.assign(node.style, {height: size}));\n            }\n\n            const productSwiper = new Swiper(productSwiperWrapper[0], {\n                pagination: '.swiper-pagination',\n                // nextButton: '.swiper-button-next',\n                // prevButton: '.swiper-button-prev',\n                paginationClickable: true,\n                // spaceBetween: 30,\n                centeredSlides: true,\n                autoplay: 6000,\n                autoplayDisableOnInteraction: false,\n                loop: true,\n                keyboardControl: true,\n                onInit: onSwiperResize,\n                onAfterResize: onSwiperResize\n            });\n\n            console.log('product swiper is here ->', productSwiper);\n        });\n};\n\nmodule.exports.initSwiperZoom = () => {\n    const product = $('.js-product');\n    const win = window;\n    const fullPageClassName = 'product--full-page';\n\n    function onWindowResize() {\n        if (product.hasClass(fullPageClassName)) {\n            return;\n        }\n\n        if (win.document.documentElement.clientWidth < 980) {\n            product.addClass(fullPageClassName);\n            return;\n        }\n\n        product.removeClass(fullPageClassName);\n    }\n\n    onWindowResize();\n\n    $(win).on('resize', onWindowResize);\n\n    $('.js-product-swiper-wrapper').on('dblclick', () => {\n        product.toggleClass(fullPageClassName);\n        win.dispatchEvent(new Event('resize'));\n    });\n};\n\nmodule.exports.initAddToBasketForm = () => {\n    const win = window;\n\n    win.app = win.app || {};\n\n    const {app} = win;\n    const {product = null} = app;\n\n    if (!product) {\n        console.log('no add to basket form');\n        return;\n    }\n\n    const form = $('.js-add-to-basket-form');\n\n    form.on('submit', evt => {\n        evt.preventDefault();\n\n        const {basket} = app;\n\n        basket.change(product, Number(form.find('.js-count').val()));\n\n        $.snackbar({\n            content: 'Товар добавлен в корзину!', // text of the snackbar\n            style: 'snackbar', // add a custom class to your snackbar\n            timeout: 3e3// time in milliseconds after the snackbar autohides, 0 is disabled\n        });\n    });\n};\n\nfunction hasCategoryTheProduct(category, productId) {\n    return category.products.indexOf(productId) !== -1;\n}\n\nfunction findProductPath(category, productId, passList, callBack, watcher) {\n    const currentPassList = JSON.parse(JSON.stringify(passList));\n    const {slug, name, displayName} = category;\n\n    currentPassList.push({slug, name, displayName});\n\n    if (hasCategoryTheProduct(category, productId) && watcher.hasResult === false) {\n        currentPassList.shift();\n        callBack(currentPassList);\n        Object.assign(watcher, {hasResult: true});\n        return true; // stop outside loop\n    }\n\n    category\n        .categories\n        .some(subCategory => findProductPath(subCategory, productId, currentPassList, callBack, watcher));\n\n    // check for top category and for no result\n    if (currentPassList.length === 1 && watcher.hasResult === false) {\n        callBack(null);\n    }\n\n    return false; // continue outside loop\n}\n\nfunction getCategoriesPath(productId) {\n    const {app} = window;\n    const categoryTree = JSON.parse(JSON.stringify(app.categoryTree));\n    const resultObject = {};\n\n    findProductPath(categoryTree, productId, [], result => Object.assign(resultObject, {result}), {hasResult: false});\n\n    return resultObject.result;\n}\n\nmodule.exports.initBreadCrumbs = () => {\n    const wrapper = document.querySelector('.js-bread-crumbs');\n\n    if (!wrapper) {\n        console.log('no wrapper for bread-crumbs');\n        return;\n    }\n\n    const {app} = window;\n    const product = JSON.parse(JSON.stringify(app.product));\n\n    const categoriesPass = getCategoriesPath(product._id); // eslint-disable-line no-underscore-dangle\n\n    if (categoriesPass === null) {\n        console.error('Can NOT create bread crumbs for product');\n        return;\n    }\n\n    const categoryHtml = categoriesPass\n        .map(({slug, name, displayName}) =>\n            '<a class=\"bread-crumbs__link\" href=\"{{href}}\">{{name}}</a>'\n                .replace('{{href}}', '/category/' + slug)\n                .replace('{{name}}', displayName || name) +\n            '<span class=\"bread-crumbs__separator\">&gt;</span>'\n        )\n        .join('');\n\n    const productHtml = '<a class=\"bread-crumbs__link secondary-color\" href=\"{{href}}\">{{name}}</a>'\n        .replace('{{href}}', '/product/' + product.slug)\n        .replace('{{name}}', product.displayName || product.name);\n\n    wrapper.innerHTML = categoryHtml + productHtml;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/product.js","/* global Image */\n\nfunction loadImage(src) {\n    return new Promise((resolve, reject) => {\n        const image = new Image();\n\n        function onLoad() {\n            image.onload = image.onerror = null;\n            resolve(image);\n        }\n\n        function onError() {\n            image.onload = image.onerror = null;\n            reject(image);\n        }\n\n        image.onload = onLoad;\n        image.onerror = onError;\n\n        image.src = src;\n    });\n}\n\nfunction loadImages(imageSrcList) {\n    return Promise.all(imageSrcList.map(loadImage));\n}\n\nmodule.exports.loadImage = loadImage;\nmodule.exports.loadImages = loadImages;\n\n\n\n// WEBPACK FOOTER //\n// ./js/helper/image.js","function checkInput(input) {\n    const {value} = input;\n\n    if (input.hasAttribute('required') && !value) {\n        return false;\n    }\n\n    const pattern = input.getAttribute('pattern');\n\n    if (!pattern) {\n        return true;\n    }\n\n    const regExp = new RegExp(pattern);\n\n    return regExp.test(value);\n}\n\nfunction checkForm(form) {\n    const inputs = Array.prototype.slice.call(form.find('input')); // eslint-disable-line prefer-reflect\n\n    return inputs.every(checkInput);\n}\n\nmodule.exports.checkInput = checkInput;\nmodule.exports.checkForm = checkForm;\n\n\n\n// WEBPACK FOOTER //\n// ./js/helper/form.js","const $ = require('jquery');\nconst Basket = require('./my-lib/basket');\n\nmodule.exports.initBasket = () => {\n    const basket = new Basket({\n        wrapper: $('.js-cart')[0],\n        counter: $('.js-counter')[0],\n        postfix: ' руб.',\n        empty: 'Нет товаров'\n    });\n\n    const win = window;\n\n    win.app = win.app || {};\n    win.app.basket = basket;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/basket.js","/* global document, history*/\nconst React = require('react');\nconst {Component} = React;\nconst ReactDOM = require('react-dom');\nconst {numberToMoney} = require('./my-lib/format');\n\nwindow.app = window.app || {};\n\nclass CartTable extends Component {\n    constructor() {\n        super();\n\n        const view = this;\n        const {app} = window;\n        const {basket} = app;\n\n        view.state = {\n            items: basket.getItems()\n        };\n    }\n\n    onInputChange(slug, newCount) {\n        const view = this;\n        const {app} = window;\n        const {basket} = app;\n\n        basket.set({slug}, newCount);\n        view.setState({\n            items: basket.getItems()\n        });\n    }\n\n    render() {\n        const view = this;\n        const {state} = view;\n        const {items} = state;\n\n        if (items.length === 0) {\n            return <h2 className=\"page-header\">Корзина пуста</h2>;\n        }\n\n        return <div>\n            <div className=\"cart\">\n                <table className=\"table\">\n                    <thead className=\"table__head\">\n                        <tr>\n                            <th className=\"table__th\">№</th>\n                            <th className=\"table__th\">Наименование товара</th>\n                            <th className=\"table__th\">Кол-во</th>\n                            <th className=\"table__th\">Цена (руб.)</th>\n                            <th className=\"table__th\">Сумма (руб.)</th>\n                            <th className=\"table__th\"/>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {items.map((product, ii) => <tr className=\"table__tr\" key={ii}>\n                            <td className=\"table__td table__td--ta-center\">{ii + 1}</td>\n                            <td className=\"table__td\">\n                                <div className=\"table__product-image\"\n                                    style={{backgroundImage: 'url(' + product.images[0] + ')'}}/>\n                                <a href={'/product/' + product.slug} className=\"table__product-name\">{product.name}</a>\n                                <p className=\"table__product-article\">Артикул: {product.article}</p>\n                            </td>\n                            <td className=\"table__td\">\n                                <input\n                                    className=\"input input--number block-center\"\n                                    type=\"number\"\n                                    min=\"1\"\n                                    defaultValue={product.count}\n                                    onBlur={onInputNumberBlur}\n                                    onChange={evt =>\n                                        view.onInputChange(product.slug, parseInt(evt.currentTarget.value, 10) || 1)}\n                                    required/>\n                            </td>\n                            <td className=\"table__td table__td--ta-right\">\n                                <span className=\"table__number\">\n                                    {numberToMoney(product.price)}\n                                </span>\n                            </td>\n                            <td className=\"table__td table__td--ta-right\">\n                                <span className=\"table__number\">\n                                    {numberToMoney(product.count * product.price)}\n                                </span>\n                            </td>\n                            <td className=\"table__td\">\n                                <span onClick={evt => view.onInputChange(product.slug, 0)} className=\"table__close\"/>\n                            </td>\n                        </tr>)}\n                        <tr>\n                            <td colSpan=\"3\">\n                                <span className=\"table__number bold\">\n                                Итого:\n                                </span>\n                            </td>\n                            <td colSpan=\"2\">\n                                <span className=\"table__number table__number--left bold\">\n                                    {numberToMoney(window.app.basket.getFullPrice())} руб.\n                                </span>\n                            </td>\n                            <td/>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <div className=\"buttons-wrapper\">\n                <button className=\"button\" onClick={() => history.back()}>продолжить покупки</button>\n                <a href=\"/ordering\" className=\"button\">оформить заказ</a>\n            </div>\n        </div>;\n    }\n}\n\nfunction onInputNumberBlur(evt) {\n    const input = evt.currentTarget;\n    const value = parseInt(input.value, 10) || 0;\n\n    if (value <= 0) {\n        input.value = 1;\n    }\n}\n\nmodule.exports.initCartTable = () => {\n    const wrapper = document.querySelector('.js-table-cart');\n\n    if (!wrapper) {\n        return;\n    }\n\n    ReactDOM.render(\n        <CartTable/>,\n        wrapper\n    );\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./js/cart.js","/* global location */\nconst $ = require('jquery');\nconst {showError} = require('./authorization');\n\nfunction createOrder(form) {\n    return new Promise((resolve, reject) => {\n        const serializedForm = form.serializeToJSON();\n        const basketItems = window.app.basket.getItems();\n        const products = basketItems\n            .map(({slug, name, count}) => JSON.stringify({slug, name, count})\n                .replace(/\":/g, '\": ')\n                .replace(/^{|}$/g, '')\n                .replace(/\",\\s?\"/g, '\"; \"')\n                .replace(/\"([\\S\\s]+?)\"/g, '$1')\n            );\n\n        $.ajax({\n            type: 'post',\n            url: '/api/create-order',\n            data: {\n                ...serializedForm,\n                products,\n                basketItems: JSON.stringify(basketItems)\n            }, // serializes the form's elements.\n            success: data => data.hasOwnProperty('error') ?\n                reject(data) :\n                resolve(data)\n        });\n    });\n}\n\nfunction updateUserData(form) {\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            type: 'post',\n            url: '/api/update',\n            data: form.serialize(), // serializes the form's elements.\n            success: data => data.hasOwnProperty('error') ?\n                reject(data) :\n                resolve(data)\n        });\n    });\n}\n\nmodule.exports.initOrderForm = () => {\n    const orderingForm = $('.js-ordering-form');\n\n    if (orderingForm.length === 0) {\n        console.log('NO ordering form');\n        return;\n    }\n\n    orderingForm.on('submit', evt => {\n        evt.preventDefault();\n\n        updateUserData(orderingForm)\n            .then(() => createOrder(orderingForm))\n            .then(data => {\n                window.app.basket.clear();\n                Object.assign(location, {href: '/order/' + data.slug + '?header=congratulation'});\n            })\n            .catch(showError);\n    });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/ordering.js","/* global document */\nconst React = require('react');\nconst {Component} = React;\nconst ReactDOM = require('react-dom');\nconst find = require('lodash/find');\n// const {browser} = require('./my-lib/browser');\n\nwindow.app = window.app || {};\n\nconst narrowWidth = 767;\n\nclass TabContent extends Component {\n    render() {\n        const view = this;\n        const {props} = view;\n        const {category} = props;\n        const {categories} = category;\n\n        if (categories.length === 0) {\n            return null;\n        }\n\n        return <div className=\"header-nav__tab-wrapper\">\n            <div className=\"category-item__wrapper clear-self\">\n                {categories.map(({image, displayName, name, slug}) =>\n                    <a key={slug} href={'/category/' + slug} className=\"category-item clear-self\">\n                        <span className=\"category-item__image\" style={{backgroundImage: 'url(' + image + ')'}}/>\n                        <p className=\"category-item__name\">{displayName || name}</p>\n                    </a>)}\n            </div>\n        </div>;\n    }\n}\n\nclass HeaderNav extends Component {\n    constructor() {\n        super();\n\n        const view = this;\n        const {app} = window;\n        const {categoryTree} = app;\n\n        view.state = {\n            categoryTree: JSON.parse(JSON.stringify(categoryTree)),\n            activeCategorySlug: null,\n            isNarrow: false,\n            wrapper: document.querySelector('.js-header-nav')\n        };\n    }\n\n    componentWillUpdate(nextProps, nextState) {\n        const view = this;\n        const {state} = view;\n        const {isNarrow} = state;\n        const nextIsNarrow = nextState.isNarrow;\n\n        if (isNarrow === nextIsNarrow) {\n            return;\n        }\n\n        view.closeTabs();\n    }\n\n    componentDidUpdate() {\n        const view = this;\n        const {state} = view;\n        const {wrapper, isNarrow} = state;\n\n        if (isNarrow) {\n            wrapper.classList.remove('header-nav__sticky');\n        } else {\n            wrapper.classList.add('header-nav__sticky');\n        }\n    }\n\n    componentDidMount() {\n        const view = this;\n\n        view.bindEvents();\n        view.onResize();\n    }\n\n    onResize() {\n        const view = this;\n        const isNarrow = document.documentElement.clientWidth < narrowWidth;\n\n        view.setState({isNarrow});\n    }\n\n    bindEvents() {\n        const view = this;\n\n        window.addEventListener('resize', () => view.onResize(), false);\n    }\n\n    openTab(slug) {\n        const view = this;\n\n        view.setState({activeCategorySlug: slug});\n    }\n\n    closeTabs() {\n        const view = this;\n\n        view.setState({activeCategorySlug: null});\n    }\n\n    switchTab(slug) {\n        const view = this;\n        const {state} = view;\n        const {activeCategorySlug} = state;\n        const newSlug = activeCategorySlug === slug ? null : slug;\n\n        view.setState({activeCategorySlug: newSlug});\n    }\n\n    narrowRender() {\n        const view = this;\n        const {state} = view;\n        const {categoryTree} = state;\n        const activeCategory = find(categoryTree.categories, {slug: state.activeCategorySlug});\n\n        return <div>\n            {categoryTree.categories\n                .sort((category1, category2) => category1.order - category2.order)\n                .map(({displayName, name, slug, categories}) => <div\n                    className=\"header-nav__link header-nav__link--narrow\"\n                    key={slug}>\n                    <a href={'/category/' + slug}\n                        className=\"header-nav__active-element\">\n                        {displayName || name}\n                    </a>\n                    {categories.length === 0 ?\n                        null :\n                        <div className=\"header-nav__switch-button\"\n                            onClick={() => view.switchTab(slug)}>\n                            {activeCategory && activeCategory.slug === slug ? '×' : '+'}\n                        </div>\n                    }\n                    {activeCategory && activeCategory.slug === slug && <TabContent category={activeCategory}/>}\n                </div>)\n            }\n        </div>;\n    }\n\n    render() {\n        const view = this;\n        const {state} = view;\n        const {categoryTree, isNarrow} = state;\n        const activeCategory = find(categoryTree.categories, {slug: state.activeCategorySlug});\n\n        if (isNarrow) {\n            return view.narrowRender();\n        }\n\n        return <div>\n            {categoryTree.categories\n                .sort((category1, category2) => category1.order - category2.order)\n                .map(({displayName, name, slug}) => <div\n                    className=\"header-nav__link\"\n                    onMouseEnter={() => view.openTab(slug)}\n                    onMouseLeave={() => view.closeTabs()}\n                    key={slug}>\n                    <a href={'/category/' + slug}\n                        className=\"header-nav__active-element\">\n                        {displayName || name}\n                    </a>\n                    {activeCategory && activeCategory.slug === slug && <TabContent category={activeCategory}/>}\n                </div>)\n            }\n        </div>;\n    }\n}\n\nmodule.exports.initHeaderNav = () => {\n    const wrapper = document.querySelector('.js-header-nav');\n    const {categoryTree} = window.app;\n\n    if (!wrapper || !categoryTree) {\n        return;\n    }\n\n    ReactDOM.render(\n        <HeaderNav/>,\n        wrapper\n    );\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/header-nav.js","/* global document, setTimeout, location */\nconst React = require('react');\nconst ReactDOM = require('react-dom');\nconst classnames = require('classnames');\nconst {normalizeString} = require('./my-lib/format');\nconst {SearchPage} = require('./search-page');\n\nclass HeaderSearch extends SearchPage {\n    constructor() {\n        super();\n\n        const view = this;\n\n        view.state = {\n            query: '',\n            products: [],\n            isInProgress: false,\n            hasFocus: false\n        };\n    }\n\n    renderList() {\n        const view = this;\n        const {state} = view;\n        const {products, hasFocus, query} = state;\n\n        if (!hasFocus || !query) {\n            return null;\n        }\n\n        if (!products.length) {\n            return <div className=\"header-search__result-list header-search__result-list--search-empty\">\n                По запросу<span className=\"bold\"> \"{query}\" </span>ничего не найдено\n            </div>;\n        }\n\n        return <div className=\"header-search__result-list\">\n            {products.map(({slug, name, description, images}) =>\n                <a href={'/product/' + slug} className=\"header-search__result-item clear-full\"\n                    key={slug}>\n                    <div className=\"header-search__result-image\" style={{backgroundImage: 'url(' + images[0] + ')'}}/>\n                    <h4 className=\"header-search__result-name\">{name}</h4>\n                    <p className=\"header-search__result-description\">{description}</p>\n                </a>)}\n        </div>;\n    }\n\n    onFormSubmit(evt) {\n        evt.preventDefault();\n\n        const view = this;\n        const {searchInput} = view.refs;\n        const query = normalizeString(searchInput.value);\n\n        Object.assign(location, {href: '/search?query=' + query});\n    }\n\n    render() {\n        const view = this;\n        const {state} = view;\n        const {isInProgress} = state;\n\n        const searchIconClassName = classnames('header-search__icon', {\n            'header-search__icon--in-progress': isInProgress\n        });\n\n        return <form className=\"header-search\" onSubmit={evt => view.onFormSubmit(evt)} ref=\"form\">\n            <input\n                ref=\"searchInput\"\n                className=\"header-search__input\"\n                placeholder=\"Поиск...\"\n                onInput={evt => view.onSearchInput()}\n                onFocus={() => {\n                    view.onSearchInput();\n                    view.setState({hasFocus: true});\n                }}\n                onBlur={() => setTimeout(() => view.setState({hasFocus: false}), 300)}\n            />\n            <div onClick={evt => view.onFormSubmit(evt)} className={searchIconClassName}/>\n            {view.renderList()}\n        </form>;\n    }\n}\n\nmodule.exports.initHeaderSearch = () => {\n    const wrapper = document.querySelector('.js-header-search');\n\n    if (!wrapper) {\n        return;\n    }\n\n    ReactDOM.render(\n        <HeaderSearch/>,\n        wrapper\n    );\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/header-search.js","/* global fetch, setTimeout */\n\nconst emptyQuery = '';\n\nconst promiseCache = {\n    [emptyQuery]: Promise.resolve({products: []})\n};\n\nfunction search(query) {\n    if (promiseCache.hasOwnProperty(query)) {\n        return promiseCache[query];\n    }\n\n    promiseCache[query] = fetch('/api/search?query=' + query)\n        .then(rawResult => rawResult.json());\n\n    return promiseCache[query];\n}\n\nmodule.exports.search = search;\n\nfunction sortProduct(products, query) {\n    return products\n        .sort((product1, product2) => {\n            const delta = product1.name.search(new RegExp(query, 'gi')) -\n                product2.name.search(new RegExp(query, 'gi'));\n\n            if (delta) {\n                return delta;\n            }\n\n            return product1.name > product2.name ? 0.5 : -0.5;\n        });\n}\n\nmodule.exports.sortProduct = sortProduct;\n\n\n\n// WEBPACK FOOTER //\n// ./js/my-lib/search.js","/* global document*/\n\nconst scrollMethods = (() => {\n    const docElem = document.documentElement;\n    let {scrollTop = 0} = docElem;\n\n    function saveScrollTop() {\n        console.log('save', docElem.scrollTop);\n        scrollTop = docElem.scrollTop;\n    }\n\n    function restoreScrollTop() {\n        console.log('restore', scrollTop);\n        docElem.scrollTop = scrollTop;\n    }\n\n    return {\n        saveScrollTop,\n        restoreScrollTop\n    };\n})();\n\n\nmodule.exports.saveScrollTop = scrollMethods.saveScrollTop;\nmodule.exports.restoreScrollTop = scrollMethods.restoreScrollTop;\n\n\n\n// WEBPACK FOOTER //\n// ./js/my-lib/screen.js","/* global document */\nfunction hasCategoryTheCategory(category, slug) {\n    return category.categories.some(subCategory => subCategory.slug === slug);\n}\n\nfunction findCategoryPath(category, categorySlug, passList, callBack, watcher) {\n    const currentPassList = JSON.parse(JSON.stringify(passList));\n    const {slug, name, displayName} = category;\n\n    currentPassList.push({slug, name, displayName});\n\n    if (hasCategoryTheCategory(category, categorySlug) && watcher.hasResult === false) {\n        currentPassList.shift();\n        callBack(currentPassList);\n        Object.assign(watcher, {hasResult: true});\n        return true; // stop outside loop\n    }\n\n    category\n        .categories\n        .some(subCategory => findCategoryPath(subCategory, categorySlug, currentPassList, callBack, watcher));\n\n    // check for top category and for no result\n    if (currentPassList.length === 1 && watcher.hasResult === false) {\n        callBack(null);\n    }\n\n    return false; // continue outside loop\n}\n\nfunction getCategoriesPath(slug) {\n    const {app} = window;\n    const categoryTree = JSON.parse(JSON.stringify(app.categoryTree));\n    const resultObject = {};\n\n    findCategoryPath(categoryTree, slug, [], result => Object.assign(resultObject, {result}), {hasResult: false});\n\n    return resultObject.result;\n}\n\nmodule.exports.initBreadCrumbs = () => {\n    const wrapper = document.querySelector('.js-category-bread-crumbs');\n\n    if (!wrapper) {\n        console.log('no wrapper for bread-crumbs');\n        return;\n    }\n\n    const {app} = window;\n    const category = JSON.parse(JSON.stringify(app.category));\n\n    const categoriesPass = getCategoriesPath(category.slug); // eslint-disable-line no-underscore-dangle\n\n    if (categoriesPass === null) {\n        console.error('Can NOT create bread crumbs for category');\n        return;\n    }\n\n    if (categoriesPass.length === 0) {\n        console.log('Sub root category - do not show bread crumbs');\n        return;\n    }\n\n    categoriesPass.push({\n        slug: category.slug,\n        name: category.name,\n        displayName: category.displayName\n    });\n\n    wrapper.innerHTML = categoriesPass\n        .map(({slug, name, displayName}) =>\n            '<a class=\"bread-crumbs__link\" href=\"{{href}}\">{{name}}</a>'\n                .replace('{{href}}', '/category/' + slug)\n                .replace('{{name}}', displayName || name)\n        )\n        .join('<span class=\"bread-crumbs__separator\">&gt;</span>');\n};\n\n\n\n// WEBPACK FOOTER //\n// ./js/category.js"],"sourceRoot":""}